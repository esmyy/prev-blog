"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[5270],{3905:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>h});var a=t(7294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function p(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function u(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var i=a.createContext({}),s=function(e){var n=a.useContext(i),t=n;return e&&(t="function"==typeof e?e(n):p(p({},n),e)),t},c=function(e){var n=s(e.components);return a.createElement(i.Provider,{value:n},e.children)},l="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},m=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,o=e.originalType,i=e.parentName,c=u(e,["components","mdxType","originalType","parentName"]),l=s(t),m=r,h=l["".concat(i,".").concat(m)]||l[m]||d[m]||o;return t?a.createElement(h,p(p({ref:n},c),{},{components:t})):a.createElement(h,p({ref:n},c))}));function h(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var o=t.length,p=new Array(o);p[0]=m;var u={};for(var i in n)hasOwnProperty.call(n,i)&&(u[i]=n[i]);u.originalType=e,u[l]="string"==typeof e?e:r,p[1]=u;for(var s=2;s<o;s++)p[s]=t[s];return a.createElement.apply(null,p)}return a.createElement.apply(null,t)}m.displayName="MDXCreateElement"},1935:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>p,default:()=>d,frontMatter:()=>o,metadata:()=>u,toc:()=>s});var a=t(7462),r=(t(7294),t(3905));const o={},p="\u8def\u7531\u8868",u={unversionedId:"frameworks/vue2/vue-router/route-map",id:"frameworks/vue2/vue-router/route-map",title:"\u8def\u7531\u8868",description:"\u5728 Vue Router \u5b9e\u4f8b\u5316\u914d\u7f6e\u7684\u65f6\u5019\uff0c\u914d\u7f6e\u7684\u662f\u4e00\u4e2a routes \u6570\u7ec4\uff0c\u7c7b\u4f3c\u4e0b\u9762\u8fd9\u6837",source:"@site/docs/05-frameworks/02-vue2/05-vue-router/04-route-map.md",sourceDirName:"05-frameworks/02-vue2/05-vue-router",slug:"/frameworks/vue2/vue-router/route-map",permalink:"/docs/frameworks/vue2/vue-router/route-map",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/05-frameworks/02-vue2/05-vue-router/04-route-map.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{},sidebar:"vue2",previous:{title:"\u4e09\u4e2a\u6a21\u5757",permalink:"/docs/frameworks/vue2/vue-router/main"},next:{title:"\u8def\u7531\u5207\u6362",permalink:"/docs/frameworks/vue2/vue-router/transition"}},i={},s=[{value:"RouteRecord",id:"routerecord",level:2},{value:"\u751f\u6210\u8def\u7531\u8868",id:"\u751f\u6210\u8def\u7531\u8868",level:2},{value:"route \u6807\u51c6\u5316",id:"route-\u6807\u51c6\u5316",level:3},{value:"\u5d4c\u5957\u8def\u7531\u5904\u7406",id:"\u5d4c\u5957\u8def\u7531\u5904\u7406",level:3},{value:"\u66f4\u65b0 map",id:"\u66f4\u65b0-map",level:3},{value:"\u603b\u7ed3",id:"\u603b\u7ed3",level:2}],c={toc:s},l="wrapper";function d(e){let{components:n,...t}=e;return(0,r.kt)(l,(0,a.Z)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"\u8def\u7531\u8868"},"\u8def\u7531\u8868"),(0,r.kt)("p",null,"\u5728 Vue Router \u5b9e\u4f8b\u5316\u914d\u7f6e\u7684\u65f6\u5019\uff0c\u914d\u7f6e\u7684\u662f\u4e00\u4e2a routes \u6570\u7ec4\uff0c\u7c7b\u4f3c\u4e0b\u9762\u8fd9\u6837"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'const router = new VueRouter({\n  routes: [\n    {\n      path: "/user",\n      name: "user",\n      component: User,\n    },\n    {\n      path: "/product",\n      name: "product",\n      component: Product,\n    },\n  ],\n});\n')),(0,r.kt)("p",null,"\u5b9e\u4f8b\u5316\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6839\u636e path\uff0cname \u5206\u522b\u751f\u6210\u4e00\u4e2a map\uff0c\u8fd9\u4e24\u4e2a map \u6211\u79f0\u4e4b\u4e3a\u8def\u7531\u8868\uff0c\u5206\u522b\u662f nameMap(\u540d\u79f0\u8def\u7531\u8868) \u548c pathMap(\u8def\u5f84\u8def\u7531\u8868)\u3002"),(0,r.kt)("p",null,"\u672c\u6587\u8bf4\u660e\u4ece routes \u5230 nameMap \u548c pathMap \u7684\u8fc7\u7a0b\u3002"),(0,r.kt)("h2",{id:"routerecord"},"RouteRecord"),(0,r.kt)("p",null,"\u8def\u7531\u8868\u91cc\u9762\u7684\u6bcf\u4e00\u9879\u662f\u4e00\u4e2a RouteRecord \u7c7b\u578b\u7684\u5bf9\u8c61\uff0c\u7c7b\u578b\u5b9a\u4e49\u5982\u4e0b"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"export interface RouteRecord {\n  path: string\n  regex: RegExp\n  components: Dictionary<Component>\n  instances: Dictionary<Vue>\n  name?: string\n  parent?: RouteRecord\n  redirect?: RedirectOption\n  matchAs?: string\n  meta: any\n  beforeEnter?: (\n    route: Route,\n    redirect: (location: RawLocation) => void,\n    next: () => void\n  ) => any\n  props:\n    | boolean\n    | Object\n    | RoutePropsFunction\n    | Dictionary<boolean | Object | RoutePropsFunction>\n}\n")),(0,r.kt)("p",null,"nameMap \u548c pathMap \u5c31\u662f\u4e0b\u9762\u8fd9\u6837\u7684\u4e00\u4e2a\u7ed3\u6784"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"nameMap: {\n  user: routeRecord1,\n  product: routeRecord2\n}\n\npathMap: {\n  '/user': routeRecord1,\n  '/product': routeRecord2\n}\n")),(0,r.kt)("p",null,"\u6709\u5982\u4e0b\u793a\u4f8b"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'import Vue from "vue";\nimport VueRouter from "vue-router";\n\nVue.use(VueRouter);\n\nconst Parent = {\n  template: `\n    <div class="parent">\n      <h2>Parent</h2>\n      <router-view class="child"></router-view>\n    </div>\n  `,\n};\n\nconst Foo = { template: "<div>foo</div>" };\nconst Bar = { template: "<div>bar</div>" };\n\nconst Qux = {\n  template: `\n    <div class="nested-parent">\n      <h3>qux</h3>\n      <router-link :to="{ name: \'quux\' }">/quux</router-link>\n      <router-view class="nested-child"></router-view>\n    </div>\n  `,\n};\n\nconst Quux = {\n  template: `<div>quux<router-link :to="{ name: \'quuy\' }">go to quuy</router-link></div>`,\n};\n\nconst router = new VueRouter({\n  mode: "history",\n  routes: [\n    {\n      path: "/parent",\n      component: Parent,\n      children: [{ path: "foo", component: Foo, alias: "foo2" }],\n    },\n    { path: "bar", component: Bar },\n    {\n      path: "qux/:quxId",\n      component: Qux,\n      children: [{ path: "quux", name: "quux", component: Quux }],\n    },\n  ],\n});\n\nnew Vue({\n  router,\n  template: `\n    <div id="app">\n      <router-view class="view"></router-view>\n    </div>\n  `,\n}).$mount("#app");\n')),(0,r.kt)("p",null,"\u751f\u6210\u7684 pathMap \u5982\u4e0b"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'{\n  "/bar": {\n    alias: []\n    components: {default: {\u2026}}\n    matchAs: undefined\n    name: "bar"\n    parent: undefined\n    path: "bar"\n    regex: /^\\/bar(?:\\/(?=$))?$/i\n    // ...\u7701\u7565\u90e8\u5206\u5c5e\u6027\n  },\n  "/parent": {\n    alias: []\n    components: {default: {\u2026}}\n    path: "/parent"\n    regex: /^\\/parent(?:\\/(?=$))?$/i\n    // ...\u7701\u7565\u90e8\u5206\u5c5e\u6027\n  },\n  "/parent/foo": {\n    alias: ["foo2"]\n    components: {\n      default: {template: "<div>foo</div>"}\n    }\n    matchAs: undefined\n    name: "foo"\n    parent: // \u6307\u5411parent\n    path: "/parent/foo"\n    regex: /^\\/parent\\/foo(?:\\/(?=$))?$/i\n    // ...\u7701\u7565\u90e8\u5206\u5c5e\u6027\n  },\n  "/parent/foo2": {\n    components: {default: undefined}\n    matchAs: "/parent/foo"\n    name: undefined\n    parent: // \u6307\u5411parent\n    path: "/parent/foo2"\n    regex: /^\\/parent\\/foo2(?:\\/(?=$))?$/i\n    // ...\u7701\u7565\u90e8\u5206\u5c5e\u6027\n  },\n  "/qux/:quxId": {\n    alias: []\n    components: {default: {\u2026}}\n    matchAs: undefined\n    name: undefined\n    parent: undefined\n    path: "qux/:quxId"\n    regex: /^\\/qux\\/((?:[^\\/]+?))(?:\\/(?=$))?$/i\n    // ...\u7701\u7565\u90e8\u5206\u5c5e\u6027\n  },\n  "/qux/:quxId/quux": {\n    alias: []\n    components: {default: {\u2026}}\n    matchAs: undefined\n    name: "quux"\n    parent: // \u6307\u5411"qux/:quxId"\n    path: "qux/:quxId/quux"\n    regex: /^\\/qux\\/((?:[^\\/]+?))\\/quux(?:\\/(?=$))?$/i\n    // ...\u7701\u7565\u90e8\u5206\u5c5e\u6027\n  }\n}\n')),(0,r.kt)("p",null,"nameMap \u7ed3\u679c\u5982\u4e0b"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"nameMap: {\n  bar: {\n    // ...\u4e0e\u4e0a\u9762\u7684\u5bf9\u5e94\n  },\n  foo: {\n    // ...\n  },\n  quux: {\n    // ...\n  }\n}\n")),(0,r.kt)("h2",{id:"\u751f\u6210\u8def\u7531\u8868"},"\u751f\u6210\u8def\u7531\u8868"),(0,r.kt)("p",null,"matcher \u7684\u521b\u5efa\u662f\u5728 src/index.js \u5b9e\u4f8b\u5316\u7684\u65f6\u5019"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"this.matcher = createMatcher(options.routes || [], this);\n")),(0,r.kt)("p",null,"\u800c matcher \u521b\u5efa\u7684\u6838\u5fc3\u4e4b\u4e00\u5c31\u662f\u505a\u4e86\u8def\u7531\u8868\u7684\u751f\u6210"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"export function createMatcher(\n  routes: Array<RouteConfig>,\n  router: VueRouter\n): Matcher {\n  const { pathList, pathMap, nameMap } = createRouteMap(routes);\n\n  // ...\u7701\u7565\u65b9\u6cd5\u5b9a\u4e49\n  return {\n    match,\n    addRoute,\n    getRoutes,\n    addRoutes,\n  };\n}\n")),(0,r.kt)("p",null,"createRouteMap \u5b9a\u4e49\u5728 src/create-route-map.js\uff0c"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'export function createRouteMap(\n  routes: Array<RouteConfig>,\n  oldPathList?: Array<string>,\n  oldPathMap?: Dictionary<RouteRecord>,\n  oldNameMap?: Dictionary<RouteRecord>,\n  parentRoute?: RouteRecord\n): {\n  pathList: Array<string>,\n  pathMap: Dictionary<RouteRecord>,\n  nameMap: Dictionary<RouteRecord>,\n} {\n  // the path list is used to control path matching priority\n  const pathList: Array<string> = oldPathList || [];\n  // $flow-disable-line\n  const pathMap: Dictionary<RouteRecord> = oldPathMap || Object.create(null);\n  // $flow-disable-line\n  const nameMap: Dictionary<RouteRecord> = oldNameMap || Object.create(null);\n\n  routes.forEach((route) => {\n    addRouteRecord(pathList, pathMap, nameMap, route, parentRoute);\n  });\n\n  // ensure wildcard routes are always at the end\n  for (let i = 0, l = pathList.length; i < l; i++) {\n    if (pathList[i] === "*") {\n      pathList.push(pathList.splice(i, 1)[0]);\n      l--;\n      i--;\n    }\n  }\n\n  return {\n    pathList,\n    pathMap,\n    nameMap,\n  };\n}\n')),(0,r.kt)("p",null,"\u5bf9\u6bcf\u4e2a\u914d\u7f6e\u9879\u8c03\u7528\u4e86 addRouteRecord \u8fdb\u884c\u8f6c\u6362\uff0c\u8fd9\u4e2a\u51fd\u6570\u6ca1\u6709\u8fd4\u56de\uff0c\u663e\u7136\u5176\u4f1a\u5bf9\u51e0\u4e2a\u53c2\u6570\u8fdb\u884c\u8bbe\u7f6e\u3002\u5728 routes \u5904\u7406\u5b8c\u6210\u540e\uff0c\u5bf9\u751f\u6210\u7684 pathList \u8fdb\u884c\u4e86\u4e00\u4e0b\u987a\u5e8f\u8c03\u6574\uff0c\u5c06\u901a\u914d\u7b26 ","*"," \u9879\u653e\u5230\u6700\u540e\u3002"),(0,r.kt)("p",null,"addRouteRecord \u5b9a\u4e49\u5982\u4e0b"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'function addRouteRecord(\n  pathList: Array<string>,\n  pathMap: Dictionary<RouteRecord>,\n  nameMap: Dictionary<RouteRecord>,\n  route: RouteConfig,\n  parent?: RouteRecord,\n  matchAs?: string\n) {\n  // ...@s1: normalize\n  const { path, name } = route;\n  const pathToRegexpOptions: PathToRegexpOptions =\n    route.pathToRegexpOptions || {};\n  const normalizedPath = normalizePath(\n    path,\n    parent,\n    pathToRegexpOptions.strict\n  );\n\n  if (typeof route.caseSensitive === "boolean") {\n    pathToRegexpOptions.sensitive = route.caseSensitive;\n  }\n\n  const record: RouteRecord = {\n    path: normalizedPath,\n    regex: compileRouteRegex(normalizedPath, pathToRegexpOptions),\n    components: route.components || { default: route.component },\n    alias: route.alias\n      ? typeof route.alias === "string"\n        ? [route.alias]\n        : route.alias\n      : [],\n    instances: {},\n    enteredCbs: {},\n    name,\n    parent,\n    matchAs,\n    redirect: route.redirect,\n    beforeEnter: route.beforeEnter,\n    meta: route.meta || {},\n    props:\n      route.props == null\n        ? {}\n        : route.components\n        ? route.props\n        : { default: route.props },\n  };\n\n  // ...@s2: \u5d4c\u5957\u8def\u7531\u5904\u7406\n  if (route.children) {\n    route.children.forEach((child) => {\n      const childMatchAs = matchAs\n        ? cleanPath(`${matchAs}/${child.path}`)\n        : undefined;\n      addRouteRecord(pathList, pathMap, nameMap, child, record, childMatchAs);\n    });\n  }\n\n  // ...@s3: \u6dfb\u52a0\u5230map\n  if (!pathMap[record.path]) {\n    pathList.push(record.path);\n    pathMap[record.path] = record;\n  }\n\n  if (route.alias !== undefined) {\n    const aliases = Array.isArray(route.alias) ? route.alias : [route.alias];\n    for (let i = 0; i < aliases.length; ++i) {\n      const alias = aliases[i];\n      const aliasRoute = {\n        path: alias,\n        children: route.children,\n      };\n      addRouteRecord(\n        pathList,\n        pathMap,\n        nameMap,\n        aliasRoute,\n        parent,\n        record.path || "/" // matchAs\n      );\n    }\n  }\n\n  if (name) {\n    if (!nameMap[name]) {\n      nameMap[name] = record;\n    } else if (process.env.NODE_ENV !== "production" && !matchAs) {\n      warn(\n        false,\n        `Duplicate named routes definition: ` +\n          `{ name: "${name}", path: "${record.path}" }`\n      );\n    }\n  }\n}\n')),(0,r.kt)("p",null,"\u5982\u4ee3\u7801\u4e2d\u7684\u6807\u8bb0\u6ce8\u91ca\u6240\u793a\uff0c\u5c06\u5185\u5bb9\u5206\u6210\u4e09\u90e8\u5206\u53bb\u7406\u89e3"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"route \u6807\u51c6\u5316"),(0,r.kt)("li",{parentName:"ul"},"\u5d4c\u5957\u8def\u7531\u7684\u5904\u7406"),(0,r.kt)("li",{parentName:"ul"},"\u8def\u7531\u8868\u7684\u751f\u6210")),(0,r.kt)("h3",{id:"route-\u6807\u51c6\u5316"},"route \u6807\u51c6\u5316"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'const { path, name } = route;\nconst pathToRegexpOptions: PathToRegexpOptions =\n  route.pathToRegexpOptions || {};\nconst normalizedPath = normalizePath(path, parent, pathToRegexpOptions.strict);\n\nif (typeof route.caseSensitive === "boolean") {\n  pathToRegexpOptions.sensitive = route.caseSensitive;\n}\n\nconst record: RouteRecord = {\n  path: normalizedPath,\n  regex: compileRouteRegex(normalizedPath, pathToRegexpOptions),\n  components: route.components || { default: route.component },\n  alias: route.alias\n    ? typeof route.alias === "string"\n      ? [route.alias]\n      : route.alias\n    : [],\n  instances: {},\n  enteredCbs: {},\n  name,\n  parent,\n  matchAs,\n  redirect: route.redirect,\n  beforeEnter: route.beforeEnter,\n  meta: route.meta || {},\n  props:\n    route.props == null\n      ? {}\n      : route.components\n      ? route.props\n      : { default: route.props },\n};\n')),(0,r.kt)("p",null,"\u8fd9\u91cc\u662f\u6839\u636e route \u8fdb\u884c\u4e86\u4e00\u4e9b\u8f6c\u6362\u5904\u7406\uff0c\u5185\u90e8\u8868\u793a\u6bcf\u4e2a\u8def\u7531\u7684\u5bf9\u8c61\u662f\u4e00\u4e2a RouteRecord \u7c7b\u578b\u7684\u5bf9\u8c61\uff0c\u6bd4 routes \u91cc\u9762\u914d\u7f6e\u7684\u590d\u6742\u591a\u4e86\u3002\u8bf4\u4e00\u4e0b\u51e0\u4e2a\u9700\u8981\u5173\u6ce8\u7684\u5c5e\u6027\u7684\u8bbe\u7f6e\uff1a"),(0,r.kt)("p",null,"alias \u505a\u4e86\u4e00\u4e2a\u6570\u7ec4\u5316\u7684\u5904\u7406\uff0c\u4ee5\u652f\u6301\u4e24\u79cd\u7c7b\u578b\u7684\u914d\u7f6e\uff0c\u652f\u6301\u591a\u4e2a\u522b\u540d\uff1b"),(0,r.kt)("p",null,"matchAs \u548c alias \u662f\u5bf9\u5e94\u7684\uff0c\u6bd4\u5982\u8bf4\u793a\u4f8b\u4e2d\u7684 /parent/foo \u548c /parent/foo2\uff0cfoo \u5177\u6709\u522b\u540d foo2\uff0cfoo2 \u5339\u914d\u4e3a foo\uff0c\u8fd9\u4e2a matchAs\uff0c\u5c31\u662f\u5339\u914d\u4e3a\uff0c\u4ee3\u8868\u7740\u539f\u6765\u53eb\u5565\u540d\uff1b"),(0,r.kt)("p",null,"parent \u662f\u9488\u5bf9\u5d4c\u5957\u8def\u7531\u7684\uff0c\u5bf9\u4e8e\u4e00\u7ea7\u8def\u7531\u662f undefined\uff1b"),(0,r.kt)("p",null,"path \u5c5e\u6027\u8c03\u7528 normalizePath \u505a\u4e86\u6807\u51c6\u5316\uff0c\u8fd9\u4e2a\u51fd\u6570\u5982\u4e0b"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'function normalizePath(\n  path: string,\n  parent?: RouteRecord,\n  strict?: boolean\n): string {\n  if (!strict) path = path.replace(/\\/$/, "");\n  if (path[0] === "/") return path;\n  if (parent == null) return path;\n  return cleanPath(`${parent.path}/${path}`);\n}\n\nfunction cleanPath(path: string): string {\n  return path.replace(/\\/\\//g, "/");\n}\n')),(0,r.kt)("p",null,"\u975e\u4e25\u683c\u6a21\u5f0f\u4e0b\u53bb\u6389\u5c3e\u90e8\u7684/\uff0c\u914d\u7f6e\u65f6 children \u91cc\u9762\u7684\u5982\u679c\u662f/\u5f00\u5934\u4f1a\u88ab\u5f53\u505a\u6839\u8def\u7531\u800c\u4e0d\u505a\u62fc\u63a5\uff0c\u6309\u7167\u5b98\u65b9\u7684\u8bf4\u6cd5\uff0c\u8fd9\u662f \u8ba9\u4f60\u5145\u5206\u7684\u4f7f\u7528\u5d4c\u5957\u7ec4\u4ef6\u800c\u65e0\u987b\u8bbe\u7f6e\u5d4c\u5957\u7684\u8def\u5f84\uff0c\u5bf9\u4e8e//\u7684\u60c5\u51b5\u5904\u7406\u6210/\u3002"),(0,r.kt)("p",null,"regex \u5c5e\u6027\u7531 compileRouteRegex \u751f\u6210"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'import Regexp from "path-to-regexp";\n\nfunction compileRouteRegex(\n  path: string,\n  pathToRegexpOptions: PathToRegexpOptions\n): RouteRegExp {\n  const regex = Regexp(path, [], pathToRegexpOptions);\n  return regex;\n}\n')),(0,r.kt)("p",null,"\u8c03\u7528 Regexp \u5c06\u751f\u6210 path \u7684\u6b63\u5219\u8868\u793a\uff0c\u8fd9\u662f\u4e3a\u4e86\u5728\u8def\u7531\u53d8\u5316\u65f6\u8fdb\u884c\u8def\u7531\u7684\u5339\u914d\uff0c\u662f\u4e2a\u5f88\u5173\u952e\u7684\u5185\u5bb9\u3002\u5177\u4f53 Regexp \u7684\u4f7f\u7528\u53c2\u8003 Regexp (opens new window)\u3002"),(0,r.kt)("h3",{id:"\u5d4c\u5957\u8def\u7531\u5904\u7406"},"\u5d4c\u5957\u8def\u7531\u5904\u7406"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// ...@s2: \u5d4c\u5957\u8def\u7531\u5904\u7406\nif (route.children) {\n  route.children.forEach((child) => {\n    const childMatchAs = matchAs\n      ? cleanPath(`${matchAs}/${child.path}`)\n      : undefined;\n    addRouteRecord(pathList, pathMap, nameMap, child, record, childMatchAs);\n  });\n}\n")),(0,r.kt)("p",null,"\u8fd9\u91cc\u505a\u4e86\u4e00\u4e2a matchAs \u7684\u5904\u7406\uff0c\u7236\u7ea7\u5177\u6709\u522b\u540d\u7684\u65f6\u5019\uff0cmatchAs \u505a\u4e00\u4e2a\u62fc\u63a5\u5904\u7406\uff0c\u7136\u540e\u5c31\u662f\u9012\u5f52\u8c03\u7528 addRouteRecord \u7ee7\u7eed\u8fdb\u884c\u8def\u7531\u5904\u7406\u3002"),(0,r.kt)("h3",{id:"\u66f4\u65b0-map"},"\u66f4\u65b0 map"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'// ...@s3: \u66f4\u65b0map\nif (!pathMap[record.path]) {\n  pathList.push(record.path);\n  pathMap[record.path] = record;\n}\n\nif (route.alias !== undefined) {\n  const aliases = Array.isArray(route.alias) ? route.alias : [route.alias];\n  for (let i = 0; i < aliases.length; ++i) {\n    const alias = aliases[i];\n    const aliasRoute = {\n      path: alias,\n      children: route.children,\n    };\n    addRouteRecord(\n      pathList,\n      pathMap,\n      nameMap,\n      aliasRoute,\n      parent,\n      record.path || "/" // matchAs\n    );\n  }\n}\n\nif (name) {\n  if (!nameMap[name]) {\n    nameMap[name] = record;\n  } else if (process.env.NODE_ENV !== "production" && !matchAs) {\n    warn(\n      false,\n      `Duplicate named routes definition: ` +\n        `{ name: "${name}", path: "${record.path}" }`\n    );\n  }\n}\n')),(0,r.kt)("p",null,"\u9996\u5148\u662f\u5c06\u5f53\u524d\u8def\u7531\u7684 path \u6dfb\u52a0\u5230 pathList\uff0cpatchList \u5c31\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u6570\u7ec4\u3002\u7136\u540e\u4fdd\u5b58\u6bcf\u4e2a\u8def\u7531\u914d\u7f6e\u6807\u51c6\u5316\u5904\u7406\u540e\u7684 path\u3002\u800c pathMap \u548c nameMap \u5206\u522b\u662f\u4ee5 path \u548c name \u4e3a\u952e\u503c\u4fdd\u5b58\u4e86 record \u5bf9\u8c61\u3002"),(0,r.kt)("p",null,"\u5bf9\u4e8e\u522b\u540d\u7684\u5904\u7406\uff0c\u5982\u679c\u6709\u522b\u540d\u5219\u9012\u5f52\u8c03\u7528 addRouteRecord\uff0c\u6ce8\u610f\u8bbe\u7f6e\u7684 matchAs \u53c2\u6570\u8bbe\u7f6e\u4e3a\u4e86 record.path\u3002"),(0,r.kt)("h2",{id:"\u603b\u7ed3"},"\u603b\u7ed3"),(0,r.kt)("p",null,"\u5904\u7406\u7684\u8fc7\u7a0b\u5e76\u4e0d\u590d\u6742\uff0c\u5c31\u662f\u5c06\u7528\u6237\u7684\u8def\u7531\u914d\u7f6e\uff0c\u8fdb\u884c\u4e86\u4e00\u4e2a\u6807\u51c6\u5316\u5904\u7406\uff0c\u8f6c\u6362\u4e3a\u7edf\u4e00\u7684 RouteRecord \u7ed3\u6784\uff0c\u6253\u5e73\u4e86\u5c42\u7ea7\uff0c\u6807\u51c6\u5316\u4e86 path\uff0c\u901a\u8fc7 path \u751f\u6210\u4e86\u5339\u914d\u7684 regex\u3002"),(0,r.kt)("p",null,"\u5728\u4e86\u89e3\u5b8c\u8def\u7531\u8868\u751f\u6210\u7684\u8fc7\u7a0b\u4e4b\u540e\uff0c\u5176\u5b9e\u8fd8\u53ea\u662f\u77e5\u5176\u7136\uff0c\u8fd8\u4e0d\u77e5\u5176\u6240\u4ee5\u7136\uff0c\u5177\u4f53\u4e3a\u4ec0\u4e48\u8981\u8fd9\u6837\uff0c\u8fd9\u4e9b\u5185\u5bb9\u53c8\u5982\u4f55\u4f7f\u7528\uff0c\u662f\u4e0b\u4e00\u6b65\u9700\u8981\u6df1\u7a76\u7684\u5185\u5bb9\u3002"),(0,r.kt)("p",null,"\u4e09\u4e2a\u4ea7\u7269\u662f pathList, pathMap \u548c nameMap\uff0cmap \u91cc\u9762\u6bcf\u4e2a\u5c5e\u6027\u503c\u662f RouteRecord \u5bf9\u8c61\uff0c\u800c RouteRecord \u5bf9\u8c61\uff0c\u8bb0\u5f55\u4e86\u6bcf\u4e2a\u8def\u7531\u4e0b\u5e94\u8be5\u6e32\u67d3\u7684\u7ec4\u4ef6\u3002\u5f53\u4ece\u4e00\u4e2a\u9875\u9762\u5207\u6362\u5230\u53e6\u4e00\u4e2a\u9875\u9762\u65f6\uff0c\u5c31\u662f\u5728\u8def\u7531\u8868\u91cc\u9762\u627e\u5230\u5bf9\u5e94\u7684 record\uff0c\u7136\u540e\u63d0\u53d6\u76f8\u5e94\u7684\u7ec4\u4ef6\uff0c\u53bb\u6e32\u67d3\u3002"))}d.isMDXComponent=!0}}]);